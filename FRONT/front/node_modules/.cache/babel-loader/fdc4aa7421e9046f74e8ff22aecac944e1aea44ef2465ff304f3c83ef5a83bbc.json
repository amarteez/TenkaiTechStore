{"ast":null,"code":"import axios from'axios';import React,{createContext,useContext,useEffect,useReducer}from'react';// Acciones\nimport{jsx as _jsx}from\"react/jsx-runtime\";const ADD_TO_CART='ADD_TO_CART';const SET_CART_ITEMS='SET_CART_ITEMS';const REMOVE_FROM_CART='REMOVE_FROM_CART';// Crear contexto de carrito\nconst CartContext=/*#__PURE__*/createContext();// Reducer para manejar el estado del carrito\nconst cartReducer=(state,action)=>{switch(action.type){case ADD_TO_CART:return[...state,action.payload];case SET_CART_ITEMS:return action.payload;case REMOVE_FROM_CART:return state.filter(item=>item.id!==action.payload);default:return state;}};// Proveedor del contexto de carrito\nexport const CartProvider=_ref=>{let{children}=_ref;const[cart,dispatch]=useReducer(cartReducer,[]);useEffect(()=>{const fetchCartItems=async()=>{try{const response=await axios.get('http://127.0.0.1:8000/api/cart/');dispatch({type:SET_CART_ITEMS,payload:response.data});}catch(error){console.error('Error fetching cart items:',error);}};fetchCartItems();},[]);const addToCart=async product=>{try{const response=await axios.post('http://127.0.0.1:8000/api/cart/add/',{product_id:product.id,quantity:1});dispatch({type:ADD_TO_CART,payload:response.data});}catch(error){console.error('Error adding to cart:',error);}};const removeFromCart=async productId=>{try{await axios.post('http://127.0.0.1:8000/api/cart/remove/',{cart_item_id:productId});dispatch({type:REMOVE_FROM_CART,payload:productId});}catch(error){console.error('Error removing from cart:',error);}};const getCartTotal=()=>{const total=cart.reduce((sum,item)=>sum+item.price*item.quantity,0);const itbms=total*0.07;return{total,itbms,grandTotal:total+itbms};};return/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart,addToCart,removeFromCart,getCartTotal},children:children});};// Hook para usar el contexto de carrito\nexport const useCart=()=>{return useContext(CartContext);};","map":{"version":3,"names":["axios","React","createContext","useContext","useEffect","useReducer","jsx","_jsx","ADD_TO_CART","SET_CART_ITEMS","REMOVE_FROM_CART","CartContext","cartReducer","state","action","type","payload","filter","item","id","CartProvider","_ref","children","cart","dispatch","fetchCartItems","response","get","data","error","console","addToCart","product","post","product_id","quantity","removeFromCart","productId","cart_item_id","getCartTotal","total","reduce","sum","price","itbms","grandTotal","Provider","value","useCart"],"sources":["C:/Users/admin/Desktop/BACK/FRONT/front/src/CartContext.js"],"sourcesContent":["import axios from 'axios';\nimport React, { createContext, useContext, useEffect, useReducer } from 'react';\n\n// Acciones\nconst ADD_TO_CART = 'ADD_TO_CART';\nconst SET_CART_ITEMS = 'SET_CART_ITEMS';\nconst REMOVE_FROM_CART = 'REMOVE_FROM_CART';\n\n// Crear contexto de carrito\nconst CartContext = createContext();\n\n// Reducer para manejar el estado del carrito\nconst cartReducer = (state, action) => {\n    switch (action.type) {\n        case ADD_TO_CART:\n            return [...state, action.payload];\n        case SET_CART_ITEMS:\n            return action.payload;\n        case REMOVE_FROM_CART:\n            return state.filter(item => item.id !== action.payload);\n        default:\n            return state;\n    }\n};\n\n// Proveedor del contexto de carrito\nexport const CartProvider = ({ children }) => {\n    const [cart, dispatch] = useReducer(cartReducer, []);\n\n    useEffect(() => {\n        const fetchCartItems = async () => {\n            try {\n                const response = await axios.get('http://127.0.0.1:8000/api/cart/');\n                dispatch({ type: SET_CART_ITEMS, payload: response.data });\n            } catch (error) {\n                console.error('Error fetching cart items:', error);\n            }\n        };\n\n        fetchCartItems();\n    }, []);\n\n    const addToCart = async (product) => {\n        try {\n            const response = await axios.post('http://127.0.0.1:8000/api/cart/add/', {\n                product_id: product.id,\n                quantity: 1,\n            });\n            dispatch({ type: ADD_TO_CART, payload: response.data });\n        } catch (error) {\n            console.error('Error adding to cart:', error);\n        }\n    };\n\n    const removeFromCart = async (productId) => {\n        try {\n            await axios.post('http://127.0.0.1:8000/api/cart/remove/', {\n                cart_item_id: productId\n            });\n            dispatch({ type: REMOVE_FROM_CART, payload: productId });\n        } catch (error) {\n            console.error('Error removing from cart:', error);\n        }\n    };\n\n    const getCartTotal = () => {\n        const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);\n        const itbms = total * 0.07;\n        return {\n            total,\n            itbms,\n            grandTotal: total + itbms\n        };\n    };\n\n    return (\n        <CartContext.Provider value={{ cart, addToCart, removeFromCart, getCartTotal }}>\n            {children}\n        </CartContext.Provider>\n    );\n};\n\n// Hook para usar el contexto de carrito\nexport const useCart = () => {\n    return useContext(CartContext);\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}